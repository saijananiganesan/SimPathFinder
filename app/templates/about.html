<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>Flask Parent Template</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/salilab.css') }}">
</head>

<body>
    <header>
        <div class="container">
            <div class="card border" style="border-color: solid black; margin-top:20px">
                <div class="card-body" style="background-color: white; height: 10rem;">
                    <div id="header1">
                        <h1 class="logo" align='center' class='text-center' style="border: none; margin-top: 2px; margin-right: 2px; margin-left: 2px;"><a href={{ url_for('home') }}> SimPathFinder </a></h1>
                    </div>
                    <div id="header1">
                        <h3 class="logo" align='center' class='text-center' style="border: none; margin-top: 2px; margin-right: 2px; margin-left: 2px;"> Find pathway type/class based on MetaCyc ontology and similar pathways in KEGG and MetaCyc based on partially annotated enzymes</h3>
                    </div>
    </header>
    <div class="container">
        <div id="navigation_lab">
            <a href="//salilab.org/">Sali Lab Home</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//salilab.org/modweb/">ModWeb</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//salilab.org/modbase/">ModBase</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//salilab.org/evaluation/">ModEval</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//salilab.org/peptide/">PCSS</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//salilab.org/foxs/">FoXS</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//integrativemodeling.org/">IMP</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//salilab.org/multifit/">MultiFit</a>
            &nbsp;&nbsp;&nbsp;
            <a href="//salilab.org/modpipe/">ModPipe</a>
            &nbsp;&nbsp;&nbsp;
        </div>
    </div>
    <div class="container">
        <div id="navigation_second">
            <a href="https://modbase.compbio.ucsf.edu/account/">Login</a>
            &nbsp;&nbsp;&nbsp;
            <a href="/foxsdock/">Web Server</a>
            &nbsp;&nbsp;&nbsp;
            <a href="/about">About SimPathFinder</a>
            &nbsp;&nbsp;&nbsp;
            <a href="/help">Help</a>
            &nbsp;&nbsp;&nbsp;
        </div>
    </div>
    </div>
    </div>

    <body>
        <div class="container">
            <div class="card border" style="border-color: solid black; margin-top:20px">
                <div class="card-body" style="background-color: white; height: 210rem;">
                    <h3>Overview</h3>
                    <p> Pathways (PWY) are a directional list of enzymes [EC:1.1.1.1, EC:4.2.3.1, EC:3.2.1.1]. We can predict the type of a UNK pathway by learning the pattern/list of enzymes present in annotated pathways. One way to learn the underlying list of enzymes is by using <a href='https://en.wikipedia.org/wiki/Language_model'>language models</a>. That is, by considering pathways as sentences made of enzymes (<a href='https://www.brenda-enzymes.org/index.php'>EC class annotations</a>) as words. We use <a href='https://arxiv.org/abs/1607.01759'>word embeddings</a> (or enzyme embeddings) to learn a vector representation for each pathway, based on the enzymes present in them. Enzyme embeddings are used as input for pathway classification (or type/ontology prediction). Since enzyme annotations have a pattern in and of itself (eg: EC:1.1.1.1 is more similar to EC:1:1:2:3 than EC:1:4:2:3â€“both textually and functionally), we can also accurately predict pathway classes for lists of partially annotated enzymes. Finally, since we represent all pathways as vectors, we can find most similar and least similar pathways in the database (DB) for any given list of partially/fully annotated enzymes.
                    </p>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="box text-center container-fluid no-padding" style="height:60vh align center">;
                                <img src="../../static/images/NLP-Metacyc.001.png" class="float-center" alt="PDBDEV.org" height="60%" width="60%" style="margin-top: 10px; margin-bottom: 10px" />
                            </div>
                            <p style="margin-bottom:1cm" ;> </p>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <p> <b> Figure 1: </b> Overview of the method used: (1) pathways (PWY) are extracted from MetaCyc and KEGG using both API and web scrapping tools. (2) PWYs are converted to enzyme embeddings. (3) Multiple classifiers are tested for pathway ontology prediction. (4) Parameters for the best performing classifiers are optimized using grid search. (5) Best classifiers are combined to build an ensemble classifier. (6) Classifiers are validated for different annotations (4 EC digits, 3 EC digits, 2 EC digits). Embeddings are used for similarity determination (2a), best performing, validated classifier is used for prediction (6a). </p>
                            </div>
                        </div>
                        <h3>1. MetaCyc and Kegg Dataset</h3>
                        <p> Enzymatic pathways were mined from Kegg (157 pathways) and MetaCyc (2560 pathways). There are 31530 enzymes in the MetaCyc dataset. Due to a disproportionately <a href='https://pubmed.ncbi.nlm.nih.gov/23530693/'> large number of pathways in MetaCyc</a>, MetaCyc pathways and ontology were used for classifcation. Kegg dataset was used for validation. </p>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="box text-center container no-padding" style="height:60vh align center">;
                                    <img src="../../static/images/metacycD.png" class="float-center" alt="PDBDEV.org" height="60%" width="60%" style="margin-top: 10px; margin-bottom: 10px" />
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="box text-center container no-padding" style="height:60vh align center">;
                                    <img src="../../static/images/metacycP.png" class="float-center" alt="PDBDEV.org" height="100%" width="100%" style="margin-top: 10px; margin-bottom: 10px" />
                                </div>
                            </div>
                            <p style="margin-bottom:2cm" ;> </p>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <p> <b> Figure 2: </b> Overview of MetaCyc data: (left) pathway types/ontology distribution (2) distribution of pathway lengths (number of enzymes) for each pathway type/ontology. </p>
                            </div>
                        </div>
                        <h3>2. FastText Enzyme Embeddings</h3>
                        <p> We use <a href='https://arxiv.org/abs/1607.01759'>word embeddings</a> (or enzyme embeddings) to learn a vector representation for each pathway, based on the enzymes present in them. The choice of using fastText is primarily based on the small size of the dataset. For the same reason, <a href='https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf'> skip-gram </a> is used to train the neural network. Min_n, window size, epochs, negative sampling were all parameterized. </p>
                        <h3>3. Spotcheck Multiple Classifiers</h3>
                        <p> Multiple multi-label multiclass classifiers were tested (SVM: support vector machines, RM: random forrest, GB: gradient boosting, MLP: multi-level perceptron, LR: logistic regression.  </p>
                                                <div class="row">
                            <div class="col-lg-6">
                                <div class="box text-center container no-padding" style="height:60vh align center">;
                                    <img src="../../static/images/accuracy.png" class="float-center" alt="PDBDEV.org" height="100%" width="100%" style="margin-top: 10px; margin-bottom: 10px" />
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="box text-center container no-padding" style="height:60vh align center">;
                                    <img src="../../static/images/loss.png" class="float-center" alt="PDBDEV.org" height="100%" width="100%" style="margin-top: 10px; margin-bottom: 10px" />
                                </div>
                            </div>
                            <p style="margin-bottom:2cm" ;> </p>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <p> <b> Figure 3: </b> Cross-validation of different classifiers tested. The two parameters used to pick top classifiers include (1) exact match accuracy (left) (2) and Hamming loss (right). For definitions on metrics see <a href='http://lpis.csd.auth.gr/publications/tsoumakas-ijdwm.pdf'> this</a>. </p>
                            </div>
                        </div>

                        <h3>4. Optimize Classifier Parameters</h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <p> All parameters were optimized using a grid search scheme and the ones which yielded highest accuracy, recall, and precision were chosen.</p>
                            </div>
                            <p style="margin-bottom:1cm" ;> </p>
                        </div>
                        <h3>5. Building Ensemble Classifier</h3>
                        <p> We combined multiple good performing classifiers to create an average voting classifier based on mean probability. The ensemble classifier performed better than any of the individual classifiers and hence was used for production. </p>
                        <h3>6. Validating Classifiers</h3>
                        <p> Ensemble classifier was used to validate different datasets. The four types of datasets that were considered include (1) Annotation:4-this includes the list of pathways with fully annotated enzymes (complete validation set), (2) Annotation:3-this includes the list of pathways with enzymes annotated to 3 digits, that is, the fourth digit of enzymes (if present) was removed, (3) Annotation:2-this includes the list of pathways with enzymes annotated to 2 digits, that is, the third and fourth digits of enzymes (if present) were removed, and finally (4) <a href='https://en.wikipedia.org/wiki/One-hot'>one hot </a> coded vectors of pathways. </p>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="box text-center container no-padding" style="height:60vh align center">;
                                    <img src="../../static/images/PR.png" class="float-left" alt="PDBDEV.org" height="80%" width="80%" style="margin-top: 10px; margin-bottom: 10px" />
                                </div>
                            </div>
                            <p style="margin-bottom:2cm" ;> </p>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <p> <b> Figure 4: </b> Precision-recall curve for the ensemble classifier. The results shown here correspond to Annotation:4 validation dataset. </p>
                            </div>
                        <p style="margin-bottom:1cm" ;> </p>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="box text-center container no-padding" style="height:60vh align center">;
                                    <img src="../../static/images/AUC.png" class="float-left" alt="PDBDEV.org" height="80%" width="80%" style="margin-top: 10px; margin-bottom: 10px" />
                                </div>
                            </div>
                            <p style="margin-bottom:2cm" ;> </p>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <p> <b> Figure 5: </b> Receiver operating characteristic (ROC) curve for the ensemble classifier. The results shown here correspond to Annotation:4 validation dataset. For definitions on metrics see <a href='http://lpis.csd.auth.gr/publications/tsoumakas-ijdwm.pdf'> this</a>. </p>
                            </div>
                        <p style="margin-bottom:1cm" ;> </p>
                        </div>


                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">#</th>

                                <th scope="col">Validation Dataset</th>
                                <th scope="col">Exact match accuracy</th>
                                <th scope="col">Hamming Loss</th>
                                <th scope="col">Accuracy</th>
                                <th scope="col">Recall</th>
                                <th scope="col">Precision</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">1</th>
                                <td>Annotation: 4 (eg: EC:1.2.3.4) </td>
                                <td>0.80</td>
                                <td>0.04</td>
                                <td>0.84</td>
                                <td>0.87</td>
                                <td>0.85</td>
                            </tr>
                            <tr>
                                <th scope="row">2</th>
                                <td>Annotation: 3 (eg: EC:1.2.3)</td>
                                <td>0.74</td>
                                <td>0.06</td>
                                <td>0.80</td>
                                <td>0.82</td>
                                <td>0.83</td>
                            </tr>
                            <tr>
                                <th scope="row">3</th>
                                <td>Annotation: 2 (eg: EC:1.2) </td>
                                <td>0.68</td>
                                <td>0.08</td>
                                <td>0.75</td>
                                <td>0.77</td>
                                <td>0.80</td>
                            </tr>
                            <tr>
                                <th scope="row">4</th>
                                <td>One hot coder </td>
                                <td>0.72</td>
                                <td>0.08</td>
                                <td>0.76</td>
                                <td>0.77</td>
                                <td>0.77</td>

                            </tr>

                        </tbody>
                    </table>
                                            <div class="row">
                            <div class="col-lg-12">
                                <p> <b> Table 1: </b> Results for all the 4 validation sets used. </p>
                            </div>
                        <p style="margin-bottom:1cm" ;> </p>
                        </div>

                </div>
            </div>
    </body>
    <footer>
        <div id="container">
            <p class="logo1" align='center' class='text-center' style="border: none; margin-bottom: 0px; margin-right: 0px; margin-left: 0px;">&copy; Copyright 2020, Sai J. Ganesan (ganesans@salilab.org)</p>
        </div>
    </footer>

</html>